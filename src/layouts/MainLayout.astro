---
import '../styles/global.css';
import logoImg from '../assets/devup logo neon.png';

interface Props {
  title: string;
  description?: string;
}

const { title, description = "DevUp Society - Where Code Meets Innovation" } = Astro.props;
---

<!DOCTYPE html>
<html lang="en" class="bg-[#030303] scroll-smooth antialiased selection:bg-[#CCFF00] selection:text-black">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title}</title>
  <meta name="description" content={description}>
  <link rel="icon" type="image/png" href="/favicon.png">
  
  <!-- SEO Meta Tags -->
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description}>
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content={title}>
  <meta name="twitter:description" content={description}>
  
  <!-- ICONS -->
  <!-- ICONS -->
  <!-- ICONS -->
  <script src="https://code.iconify.design/iconify-icon/2.1.0/iconify-icon.min.js"></script>
  
  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
  
  <!-- FONTS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>

<body class="loading">
  <!-- OVERLAYS -->
  <div class="noise"></div>
  <div class="scanlines"></div>
  
  <!-- CURSOR -->
  <div class="cursor-dot hidden md:block"></div>
  <div class="cursor-ring hidden md:block"></div>

  <!-- PRELOADER -->
  <div class="loader" id="loader">
    <div class="flex flex-col items-center gap-4">
      <div class="font-mono text-signal text-xs tracking-[0.5em] uppercase">System Boot</div>
      <div class="w-48 h-[1px] bg-zinc-800 relative overflow-hidden">
        <div id="loader-bar" class="absolute inset-0 bg-signal origin-left" style="width: 0%"></div>
      </div>
      <div class="font-display font-bold text-6xl text-white tracking-tighter" id="loader-text">000</div>
    </div>
  </div>

  <!-- NAV -->
  <nav class="fixed top-0 w-full z-50 px-6 py-4 flex justify-between items-center bg-gradient-to-b from-[#030303] to-transparent">
    <a href="/" class="flex items-center gap-4 group cursor-pointer">
      <div class="w-10 h-10 border border-zinc-800 bg-zinc-900/50 flex items-center justify-center clip-corner group-hover:border-signal/50 transition-colors p-1">
        <img src={logoImg.src} alt="DevUp" class="w-full h-full object-contain" />
      </div>
      <div class="flex flex-col">
        <span class="font-display font-bold text-white tracking-tight leading-none group-hover:text-signal transition-colors">DEVUP</span>
        <span class="font-mono text-[9px] text-zinc-500 tracking-widest uppercase">Ver. 1.0.0 // Active</span>
      </div>
    </a>

    <!-- Desktop Navigation -->
    <div class="hidden md:flex items-center gap-1 bg-zinc-900/40 backdrop-blur-md p-1 border border-white/5 rounded-none clip-corner">
      <a href="/#about" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">About</a>
      <a href="/events" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">Events</a>
      <a href="/team" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">Team</a>
      <a href="/join" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">Join Now</a>
    </div>

    <a href="/community" class="hidden md:flex items-center gap-3 px-6 py-2.5 bg-signal text-black font-mono text-[11px] font-bold tracking-widest uppercase hover:bg-white transition-colors clip-corner btn-glitch">
      <span class="relative z-10">DevUp Community</span>
      <iconify-icon icon="lucide:arrow-up-right" class="relative z-10"></iconify-icon>
    </a>

    <!-- Mobile Hamburger Button -->
    <button id="mobile-menu-toggle" class="md:hidden w-10 h-10 border border-zinc-800 bg-zinc-900/50 flex items-center justify-center clip-corner hover:border-signal/50 transition-colors" aria-label="Toggle menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
    </button>
  </nav>

  <!-- Mobile Navigation Panel -->
  <div id="mobile-menu" class="fixed top-0 right-0 h-screen w-80 bg-black/95 backdrop-blur-lg border-l border-zinc-800 transform translate-x-full transition-transform duration-300 z-40 md:hidden">
    <div class="flex flex-col h-full p-8">
      <!-- Close Button -->
      <div class="flex justify-end mb-12">
        <button id="mobile-menu-close" class="w-10 h-10 border border-zinc-800 flex items-center justify-center hover:border-signal/50 transition-colors" aria-label="Close menu">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>

      <!-- Mobile Links -->
      <div class="flex flex-col gap-6 mb-12">
        <a href="/#about" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">About</a>
        <a href="/events" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">Events</a>
        <a href="/team" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">Team</a>
        <a href="/join" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">Join Now</a>
      </div>

      <!-- Mobile CTA -->
      <a href="/community" class="w-full flex items-center justify-center gap-3 px-6 py-4 bg-signal text-black font-mono text-xs font-bold tracking-widest uppercase hover:bg-white transition-colors clip-corner">
        <span>DevUp Community</span>
        <iconify-icon icon="lucide:arrow-up-right"></iconify-icon>
      </a>

      <!-- Mobile Social Links -->
      <div class="mt-auto pt-8 border-t border-zinc-900">
        <p class="font-mono text-xs text-zinc-600 uppercase tracking-widest mb-4">Follow Us</p>
        <div class="flex gap-4">
          <a href="https://github.com/DevUp-Society" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <iconify-icon icon="lucide:github" class="text-xl"></iconify-icon>
          </a>
          <a href="https://www.linkedin.com/company/devup-community" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <iconify-icon icon="lucide:linkedin" class="text-xl"></iconify-icon>
          </a>
          <a href="https://www.instagram.com/devupcommunity/" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <iconify-icon icon="lucide:instagram" class="text-xl"></iconify-icon>
          </a>
          <a href="https://chat.whatsapp.com/CvU68WlMmoo5PvIBpOU5Dy" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <iconify-icon icon="lucide:message-circle" class="text-xl"></iconify-icon>
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Script -->
  <script is:inline>
    // Mobile menu toggle
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenuClose = document.getElementById('mobile-menu-close');
    const mobileMenu = document.getElementById('mobile-menu');
    const hamburgerIcon = document.getElementById('hamburger-icon');

    function openMobileMenu() {
      mobileMenu.classList.remove('translate-x-full');
    }

    function closeMobileMenu() {
      mobileMenu.classList.add('translate-x-full');
    }

    if (mobileMenuToggle) {
      mobileMenuToggle.addEventListener('click', () => {
        if (mobileMenu.classList.contains('translate-x-full')) {
          openMobileMenu();
        } else {
          closeMobileMenu();
        }
      });
    }

    if (mobileMenuClose) {
      mobileMenuClose.addEventListener('click', closeMobileMenu);
    }

    // Close menu when clicking on a link
    const mobileMenuLinks = mobileMenu.querySelectorAll('a');
    mobileMenuLinks.forEach(link => {
      link.addEventListener('click', closeMobileMenu);
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!mobileMenu.contains(e.target) && !mobileMenuToggle.contains(e.target) && !mobileMenu.classList.contains('translate-x-full')) {
        closeMobileMenu();
      }
    });
  </script>

  <main>
    <slot />
  </main>

  <!-- Footer -->
  <footer class="border-t border-zinc-900/50 py-12 px-12">
    <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center text-[10px] font-mono text-zinc-600 uppercase tracking-widest gap-4">
      <div class="flex gap-8">
        <a href="https://www.instagram.com/devupcommunity/" target="_blank" rel="noopener noreferrer" class="hover:text-white transition-colors">Instagram</a>
        <a href="https://www.linkedin.com/company/devup-community" target="_blank" rel="noopener noreferrer" class="hover:text-white transition-colors">LinkedIn</a>
        <a href="https://github.com/DevUp-Society" target="_blank" rel="noopener noreferrer" class="hover:text-white transition-colors">GitHub</a>
        <a href="https://chat.whatsapp.com/CvU68WlMmoo5PvIBpOU5Dy" target="_blank" rel="noopener noreferrer" class="hover:text-white transition-colors">WhatsApp</a>
      </div>
      <div>
        Â© 2026 DevUp Society // All Rights Reserved
      </div>
    </div>
  </footer>

  <script is:inline>
    // @ts-nocheck - GSAP loaded from CDN, types not available at build time
    
    // --- LOADER LOGIC ---
    const loader = document.getElementById('loader');
    const loaderText = document.getElementById('loader-text');
    const loaderBar = document.getElementById('loader-bar');
    
    // Only show loader on home page
    const isHomePage = window.location.pathname === '/';
    
    if (!isHomePage) {
      // Not home page - skip loader entirely
      loader.style.display = 'none';
      document.body.classList.remove('loading');
    } else {
      // Home page - show loader EVERY time with 4-5 second animation
      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.floor(Math.random() * 4) + 2; // Gradual increment (2-5 per tick)
        if(progress > 100) progress = 100;
        
        // Update both percentage text AND bar width
        loaderText.innerText = progress < 100 ? `0${progress}` : '100';
        loaderBar.style.width = `${progress}%`;
        
        if(progress === 100) {
          clearInterval(interval);
          // Wait 800ms at 100% before hiding
          setTimeout(() => {
            loader.style.transform = 'translateY(-100%)';
            document.body.classList.remove('loading');
          }, 800);
        }
      }, 80); // Faster interval (80ms per tick) = ~4-5 seconds total
    }

    // --- CURSOR LOGIC ---
    const cursorDot = document.querySelector('.cursor-dot');
    const cursorRing = document.querySelector('.cursor-ring');

    if (window.matchMedia("(pointer: fine)").matches && cursorDot && cursorRing) {
      let mouseX = 0, mouseY = 0;
      let ringX = 0, ringY = 0;

      window.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        cursorDot.style.transform = `translate(${mouseX}px, ${mouseY}px) translate(-50%, -50%)`;
      });

      const animateRing = () => {
        ringX += (mouseX - ringX) * 0.3; // Increased from 0.15 to 0.3 for faster response
        ringY += (mouseY - ringY) * 0.3;
        cursorRing.style.transform = `translate(${ringX}px, ${ringY}px) translate(-50%, -50%)`;
        requestAnimationFrame(animateRing);
      }
      animateRing();

      // Interactive Elements
      document.querySelectorAll('a, button, .spotlight-card').forEach((el) => {
        el.addEventListener('mouseenter', () => {
          cursorRing.style.width = '50px';
          cursorRing.style.height = '50px';
          cursorRing.style.backgroundColor = 'rgba(204, 255, 0, 0.1)';
          cursorRing.style.borderColor = 'transparent';
        });
        el.addEventListener('mouseleave', () => {
          cursorRing.style.width = '20px';
          cursorRing.style.height = '20px';
          cursorRing.style.backgroundColor = 'transparent';
          cursorRing.style.borderColor = 'rgba(204, 255, 0, 0.5)';
        });
      });
    }

    // --- SPOTLIGHT EFFECT ---
    const cards = document.querySelectorAll('.spotlight-card');
    window.addEventListener('mousemove', (e) => {
      cards.forEach((card) => {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        card.style.setProperty("--mouse-x", `${x}px`);
        card.style.setProperty("--mouse-y", `${y}px`);
      });
    });

    // --- GSAP ANIMATIONS ---
    // Wait for GSAP to load from CDN
    if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {
      gsap.registerPlugin(ScrollTrigger);

      // Scroll reveal for sections
      gsap.utils.toArray('section').forEach((section) => {
        gsap.from(section.querySelectorAll('h2, h3, p'), {
          scrollTrigger: {
            trigger: section,
            start: "top 80%",
            toggleActions: "play none none reverse"
          },
          y: 30,
          opacity: 0,
          duration: 0.8,
          stagger: 0.1,
          ease: "power3.out"
        });
      });
    }
  </script>
</body>
</html>
