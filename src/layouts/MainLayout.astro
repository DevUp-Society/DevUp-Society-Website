---
/**
 * MainLayout.astro - Core Layout Component
 * 
 * This is the primary layout for all pages on devupvjit.in
 * It includes comprehensive SEO infrastructure:
 * - Organization Schema (Entity SEO)
 * - EducationalOrganization Schema
 * - WebSite Schema with SearchAction
 * - FAQPage Schema (AEO - Answer Engine Optimization)
 * - LocalBusiness Schema (Google Maps)
 * - BreadcrumbList Schema
 * 
 * Per-page schemas can be passed via the `schema` prop (single object or array)
 * 
 * @version 2.0.0
 * @updated 2024-01-XX
 */
import '../styles/global.css';
import logoImg from '../assets/devup logo neon.png';
import Footer from '../components/Footer.astro';
import { Icon } from 'astro-icon/components';

interface Props {
  title: string;
  description?: string;
  keywords?: string;
  type?: 'website' | 'article' | 'event' | 'profile';
  image?: string;
  publishedTime?: string;
  modifiedTime?: string;
  author?: string;
  schema?: object | object[]; // Supports single schema or array of schemas
  noindex?: boolean; // For pages that shouldn't be indexed
}

const { 
  title, 
  description = "DevUp Society is India's premier student developer community. Join hackathons, build open-source projects, and launch your tech career with 100+ active members.",
  keywords = "DevUp Society, developer community, student coding club, hackathon community, tech community India, coding community for students, open source community, VJIT coding club, Hyderabad tech community, developer network",
  type = "website",
  image = "https://www.devupvjit.in/assets/og-image.jpg",
  publishedTime,
  modifiedTime,
  author,
  schema,
  noindex = false
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site || 'https://www.devupvjit.in');
const currentYear = new Date().getFullYear();

// Helper to render schema - handles both single object and array
const renderSchema = (schemaData: object | object[] | undefined): string | null => {
  if (!schemaData) return null;
  if (Array.isArray(schemaData)) {
    return JSON.stringify(schemaData);
  }
  return JSON.stringify(schemaData);
};
---

<!DOCTYPE html>
<html lang="en" class="bg-[#030303] scroll-smooth antialiased selection:bg-[#CCFF00] selection:text-black">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title}</title>
  <meta name="description" content={description}>
  <meta name="keywords" content={keywords}>
  <meta name="author" content="DevUp Society">
  {noindex ? (
    <meta name="robots" content="noindex, nofollow">
  ) : (
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1">
  )}
  <meta name="googlebot" content={noindex ? "noindex, nofollow" : "index, follow"}>
  <link rel="canonical" href={canonicalURL} />
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#22C55E">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  <!-- Geo & Language Targeting -->
  <meta name="geo.region" content="IN-TG">
  <meta name="geo.placename" content="Hyderabad, Telangana, India">
  <meta name="geo.position" content="17.3917;78.3362">
  <meta name="ICBM" content="17.3917, 78.3362">
  <meta http-equiv="content-language" content="en-IN">
  
  <!-- Additional SEO Meta -->
  <meta name="revisit-after" content="7 days">
  <meta name="distribution" content="global">
  <meta name="rating" content="general">
  <meta name="language" content="en">
  
  <!-- SEO Meta Tags - Open Graph -->
  <meta property="og:title" content={title}>
  <meta property="og:description" content={description}>
  <meta property="og:type" content={type === 'event' ? 'event' : type === 'article' ? 'article' : 'website'}>
  <meta property="og:url" content={canonicalURL}>
  <meta property="og:image" content={image}>
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:alt" content="DevUp Society - Premier Student Developer Community">
  <meta property="og:site_name" content="DevUp Society">
  <meta property="og:locale" content="en_IN">
  {publishedTime && <meta property="article:published_time" content={publishedTime} />}
  {modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}
  {author && <meta property="article:author" content={author} />}
  
  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@devup_society">
  <meta name="twitter:creator" content="@devup_society">
  <meta name="twitter:title" content={title}>
  <meta name="twitter:description" content={description}>
  <meta name="twitter:image" content={image}>
  <meta name="twitter:image:alt" content="DevUp Society - Premier Student Developer Community">

  <!-- Organization Schema (Primary Entity) -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "@id": "https://www.devupvjit.in/#organization",
      "name": "DevUp Society",
      "alternateName": ["DevUp", "DEVUP", "DevUp Community", "DevUp VJIT"],
      "url": "https://www.devupvjit.in/",
      "logo": {
        "@type": "ImageObject",
        "url": "https://www.devupvjit.in/assets/devup-logo-neon.png",
        "width": 512,
        "height": 512
      },
      "image": "https://www.devupvjit.in/assets/og-image.jpg",
      "description": "DevUp Society is India's premier student developer community based in Hyderabad, focusing on open-source contribution, product development, hackathons, and launching tech careers. Founded at VJIT, we build real-world software and foster innovation.",
      "foundingDate": "2024",
      "foundingLocation": {
        "@type": "Place",
        "name": "Vidya Jyothi Institute of Technology",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Hyderabad",
          "addressRegion": "Telangana",
          "addressCountry": "IN"
        }
      },
      "areaServed": [
        {
          "@type": "Country",
          "name": "India"
        },
        {
          "@type": "GeoCircle",
          "geoMidpoint": {
            "@type": "GeoCoordinates",
            "latitude": 17.4126,
            "longitude": 78.2679
          },
          "geoRadius": "50000"
        }
      ],
      "sameAs": [
        "https://www.linkedin.com/company/devup-society",
        "https://www.linkedin.com/company/devup-community",
        "https://www.instagram.com/devupcommunity/",
        "https://twitter.com/devup_society",
        "https://github.com/DevUp-Society"
      ],
      "contactPoint": [
        {
          "@type": "ContactPoint",
          "email": "devupsociety@vjit.ac.in",
          "contactType": "community support",
          "availableLanguage": ["English", "Hindi", "Telugu"]
        }
      ],
      "memberOf": {
        "@type": "EducationalOrganization",
        "name": "Vidya Jyothi Institute of Technology",
        "url": "https://vjit.ac.in"
      },
      "knowsAbout": [
        "Software Engineering",
        "Web Development",
        "Full-Stack Development",
        "DevOps",
        "Cloud Computing",
        "Artificial Intelligence",
        "Machine Learning",
        "Open Source",
        "Hackathons",
        "Mobile App Development",
        "React",
        "Node.js",
        "Python",
        "JavaScript",
        "TypeScript"
      ],
      "slogan": "Code. Build. Deploy.",
      "numberOfEmployees": {
        "@type": "QuantitativeValue",
        "minValue": 50,
        "maxValue": 150
      }
    }
  </script>

  <!-- Educational Organization Schema -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "EducationalOrganization",
      "@id": "https://www.devupvjit.in/#educationalorg",
      "name": "DevUp Society",
      "description": "Student-run developer community offering hands-on technical education through workshops, hackathons, and real-world project development.",
      "url": "https://www.devupvjit.in/",
      "educationalCredentialAwarded": "Project Portfolio & Industry Skills",
      "teaches": [
        "Full-Stack Web Development",
        "DevOps & Cloud Infrastructure",
        "AI/ML Engineering",
        "Mobile App Development",
        "Open Source Contribution"
      ],
      "hasCredential": {
        "@type": "EducationalOccupationalCredential",
        "name": "DevUp Society Membership",
        "credentialCategory": "Community Membership"
      }
    }
  </script>

  <!-- WebSite Schema with SearchAction -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "@id": "https://www.devupvjit.in/#website",
      "name": "DevUp Society",
      "url": "https://www.devupvjit.in/",
      "description": "Official website of DevUp Society - India's premier student developer community",
      "publisher": {
        "@id": "https://www.devupvjit.in/#organization"
      },
      "potentialAction": {
        "@type": "SearchAction",
        "target": {
          "@type": "EntryPoint",
          "urlTemplate": "https://www.devupvjit.in/search?q={search_term_string}"
        },
        "query-input": "required name=search_term_string"
      },
      "inLanguage": "en-IN"
    }
  </script>

  <!-- BreadcrumbList Schema -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://www.devupvjit.in/"
        }
      ]
    }
  </script>

  <!-- FAQ Schema (AEO Optimization) -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "What is DevUp Society?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "DevUp Society is India's premier student developer community based in Hyderabad at VJIT. Unlike traditional coding clubs, DevUp operates as a product-first organization where members build real-world software, contribute to open source, participate in hackathons, and develop industry-ready skills. Founded in 2024, DevUp has grown to 100+ active members."
          }
        },
        {
          "@type": "Question",
          "name": "How do I join DevUp Society?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "To join DevUp Society, visit the official website at devupvjit.in/join during recruitment periods. You can also join the WhatsApp community for updates on recruitment cycles, events, and workshops. DevUp welcomes students passionate about coding, building projects, and learning new technologies."
          }
        },
        {
          "@type": "Question",
          "name": "What events does DevUp Society organize?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "DevUp Society organizes hackathons, coding bootcamps, technical workshops, tech talks, and industry meetups. Events cover topics like Full-Stack Development, DevOps, AI/ML, Mobile Development, and Open Source contribution. Check devupvjit.in/events for upcoming events."
          }
        },
        {
          "@type": "Question",
          "name": "Is DevUp Society free to join?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, DevUp Society is a free student community. There are no membership fees. Members gain access to workshops, hackathons, mentorship, project collaboration, and industry networking opportunities at no cost."
          }
        },
        {
          "@type": "Question",
          "name": "Where is DevUp Society located?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "DevUp Society is based at Vidya Jyothi Institute of Technology (VJIT) in Hyderabad, Telangana, India. While headquartered at VJIT, DevUp welcomes students from all colleges and operates both in-person and online activities."
          }
        },
        {
          "@type": "Question",
          "name": "What skills can I learn at DevUp Society?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "At DevUp Society, you can learn Full-Stack Web Development (MERN, Django, Next.js), DevOps & Cloud (Docker, Kubernetes, AWS), AI/ML Engineering (PyTorch, TensorFlow, LLMs), Mobile Development (React Native, Flutter), and Open Source contribution. All learning is hands-on through real projects."
          }
        },
        {
          "@type": "Question",
          "name": "Does DevUp Society help with internships and jobs?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Yes, DevUp Society helps members build portfolio-ready projects, develop industry connections, and gain skills that land jobs. Members have secured internships and roles at startups and tech companies through skills and projects developed at DevUp."
          }
        },
        {
          "@type": "Question",
          "name": "What is the difference between DevUp Society and other coding clubs?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "DevUp Society is product-first, not theory-first. While traditional coding clubs focus on tutorials and competitions, DevUp focuses on shipping real software. Members work on production-grade projects, contribute to open source, and build portfolios that demonstrate real engineering skills."
          }
        }
      ]
    }
  </script>

  <!-- LocalBusiness Schema for Google Maps -->
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "LocalBusiness",
      "@id": "https://www.devupvjit.in/#localbusiness",
      "name": "DevUp Society",
      "image": "https://www.devupvjit.in/assets/og-image.jpg",
      "url": "https://www.devupvjit.in/",
      "telephone": "",
      "email": "devupsociety@vjit.ac.in",
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "Vidya Jyothi Institute of Technology, Aziz Nagar Gate",
        "addressLocality": "Hyderabad",
        "addressRegion": "Telangana",
        "postalCode": "500075",
        "addressCountry": "IN"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": 17.4126,
        "longitude": 78.2679
      },
      "openingHoursSpecification": {
        "@type": "OpeningHoursSpecification",
        "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
        "opens": "09:00",
        "closes": "18:00"
      },
      "priceRange": "Free",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "reviewCount": "50"
      }
    }
  </script>

  {schema && (
    Array.isArray(schema) ? (
      schema.map(s => (
        <script type="application/ld+json" set:html={JSON.stringify(s)} />
      ))
    ) : (
      <script type="application/ld+json" set:html={JSON.stringify(schema)} />
    )
  )}
  
  <!-- ICONS -->
  <!-- Iconify script removed for production bundling -->
  
  <!-- GSAP -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
  
  <!-- FONTS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>

<body class="loading">
  <!-- OVERLAYS -->
  <div class="noise"></div>
  <div class="scanlines"></div>
  
  <!-- CURSOR -->
  <div class="cursor-dot hidden md:block"></div>
  <div class="cursor-ring hidden md:block"></div>

  <!-- PRELOADER -->
  <div class="loader flex-col" id="loader">
    <!-- Background Code Rain / Logs -->
    <div id="boot-log" class="absolute inset-0 p-4 md:p-10 font-mono text-[10px] md:text-xs text-green-500/20 overflow-hidden flex flex-col justify-end select-none pointer-events-none break-all whitespace-pre-wrap leading-tight font-bold mix-blend-screen z-0"></div>
    
    <!-- Vignette Overlay -->
    <div class="absolute inset-0 bg-[radial-gradient(circle,transparent_40%,#000_100%)] z-0"></div>

    <div class="relative z-10 flex flex-col items-center gap-4 p-8 bg-black/40 backdrop-blur-md border border-white/5 rounded-2xl shadow-2xl shadow-signal/10">
      <div class="font-mono text-signal text-xs tracking-[0.5em] uppercase" id="loader-system">SYSTEM BOOT</div>
      <div class="w-64 h-[2px] bg-zinc-800 relative overflow-hidden rounded-full">
        <div id="loader-bar" class="absolute inset-0 bg-signal origin-left shadow-[0_0_15px_#CCFF00]" style="width: 0%"></div>
      </div>
      <div class="font-display font-bold text-7xl text-white tracking-tighter tabular-nums drop-shadow-[0_0_10px_rgba(255,255,255,0.5)]" id="loader-text">000</div>
      <div class="font-mono text-zinc-500 text-[10px] tracking-widest uppercase h-4 w-full text-center" id="loader-status">INITIALIZING...</div>
    </div>
  </div>

  <!-- NAV -->
  <nav class="fixed top-0 w-full z-50 px-6 py-4 flex justify-between items-center bg-gradient-to-b from-[#030303] to-transparent">
    <a href="/" class="flex items-center gap-4 group cursor-pointer">
      <div class="w-10 h-10 border border-zinc-800 bg-zinc-900/50 flex items-center justify-center clip-corner group-hover:border-signal/50 transition-colors p-1">
        <img src={logoImg.src} alt="DevUp" class="w-full h-full object-contain" />
      </div>
      <div class="flex flex-col">
        <span class="font-display font-bold text-white tracking-tight leading-none group-hover:text-signal transition-colors">DEVUP</span>
        <span class="font-mono text-[9px] text-zinc-500 tracking-widest uppercase">Ver. 1.0.0 // Active</span>
      </div>
    </a>

    <!-- Desktop Navigation -->
    <div class="hidden md:flex items-center gap-1 bg-zinc-900/40 backdrop-blur-md p-1 border border-white/5 rounded-none clip-corner">
      <a href="/#about" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">About</a>
      <a href="/events" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">Events</a>
      <a href="/team" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">Team</a>
      <a href="/join" class="px-6 py-2 text-[10px] font-mono uppercase tracking-widest text-zinc-400 hover:text-white hover:bg-white/5 transition-all">Join Now</a>
      
      <!-- Terminal Toggle Button -->
      <button id="terminal-btn" class="px-3 py-2 text-zinc-500 hover:text-signal hover:bg-white/5 transition-all border-l border-white/5" aria-label="Open Terminal">
        <Icon name="mdi:console" class="text-sm w-4 h-4" />
      </button>
    </div>

    <a href="/community" class="hidden md:flex items-center gap-3 px-6 py-2.5 bg-signal text-black font-mono text-[11px] font-bold tracking-widest uppercase hover:bg-white transition-colors clip-corner btn-glitch">
      <span class="relative z-10">DevUp Community</span>
      <Icon name="mdi:arrow-top-right" class="relative z-10 w-4 h-4" />
    </a>

    <!-- Mobile Hamburger Button -->
    <button id="mobile-menu-toggle" class="md:hidden w-10 h-10 border border-zinc-800 bg-zinc-900/50 flex items-center justify-center clip-corner hover:border-signal/50 transition-colors" aria-label="Toggle menu">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
    </button>
  </nav>

  <!-- Mobile Navigation Panel -->
  <div id="mobile-menu" class="fixed top-0 right-0 h-screen w-80 bg-black/95 backdrop-blur-lg border-l border-zinc-800 transform translate-x-full transition-transform duration-300 z-40 md:hidden">
    <div class="flex flex-col h-full p-8">
      <!-- Close Button -->
      <div class="flex justify-end mb-12">
        <button id="mobile-menu-close" class="w-10 h-10 border border-zinc-800 flex items-center justify-center hover:border-signal/50 transition-colors" aria-label="Close menu">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
        </button>
      </div>

      <!-- Mobile Links -->
      <div class="flex flex-col gap-6 mb-12">
        <a href="/#about" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">About</a>
        <a href="/events" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">Events</a>
        <a href="/team" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">Team</a>
        <a href="/join" class="font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4">Join Now</a>
        <button id="mobile-terminal-btn" class="text-left font-mono text-sm uppercase tracking-widest text-zinc-400 hover:text-signal transition-colors border-l-2 border-transparent hover:border-signal pl-4 flex items-center gap-2">
          <Icon name="mdi:console" class="w-4 h-4" />
          System Console
        </button>
      </div>

      <!-- Mobile CTA -->
      <a href="/community" class="w-full flex items-center justify-center gap-3 px-6 py-4 bg-signal text-black font-mono text-xs font-bold tracking-widest uppercase hover:bg-white transition-colors clip-corner">
        <span>DevUp Community</span>
        <Icon name="mdi:arrow-top-right" class="w-4 h-4" />
      </a>

      <!-- Mobile Social Links -->
      <div class="mt-auto pt-8 border-t border-zinc-900">
        <p class="font-mono text-xs text-zinc-600 uppercase tracking-widest mb-4">Follow Us</p>
        <div class="flex gap-4">
          <a href="https://github.com/DevUp-Society" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <Icon name="mdi:github" class="text-xl w-6 h-6" />
          </a>
          <a href="https://www.linkedin.com/company/devup-community" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <Icon name="mdi:linkedin" class="text-xl w-6 h-6" />
          </a>
          <a href="https://www.instagram.com/devupcommunity/" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <Icon name="mdi:instagram" class="text-xl w-6 h-6" />
          </a>
          <a href="https://chat.whatsapp.com/CvU68WlMmoo5PvIBpOU5Dy" target="_blank" rel="noopener noreferrer" class="text-zinc-600 hover:text-signal transition-colors">
            <Icon name="mdi:whatsapp" class="text-xl w-6 h-6" />
          </a>
          <a href="mailto:devupsociety@vjit.ac.in" class="text-zinc-600 hover:text-signal transition-colors">
            <Icon name="mdi:email" class="text-xl w-6 h-6" />
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Mobile Menu Script -->
  <script is:inline>
    // Mobile menu toggle
    const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
    const mobileMenuClose = document.getElementById('mobile-menu-close');
    const mobileMenu = document.getElementById('mobile-menu');
    const hamburgerIcon = document.getElementById('hamburger-icon');

    function openMobileMenu() {
      mobileMenu.classList.remove('translate-x-full');
    }

    function closeMobileMenu() {
      mobileMenu.classList.add('translate-x-full');
    }

    if (mobileMenuToggle) {
      mobileMenuToggle.addEventListener('click', () => {
        if (mobileMenu.classList.contains('translate-x-full')) {
          openMobileMenu();
        } else {
          closeMobileMenu();
        }
      });
    }

    if (mobileMenuClose) {
      mobileMenuClose.addEventListener('click', closeMobileMenu);
    }

    // Close menu when clicking on a link
    const mobileMenuLinks = mobileMenu.querySelectorAll('a');
    mobileMenuLinks.forEach(link => {
      link.addEventListener('click', closeMobileMenu);
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
      if (!mobileMenu.contains(e.target) && !mobileMenuToggle.contains(e.target) && !mobileMenu.classList.contains('translate-x-full')) {
        closeMobileMenu();
      }
    });
  </script>

  <main>
    <slot />
  </main>

  <!-- Footer -->
  <Footer />

  <!-- DEVSOC TERMINAL OVERLAY -->
  <div id="dev-terminal" class="fixed inset-0 z-[100] bg-black/80 backdrop-blur-xl hidden flex items-center justify-center pt-20 pb-20 px-4 opacity-0 transition-opacity duration-300">
    <div class="w-full max-w-2xl bg-[#0a0a0a] border border-zinc-800 rounded-lg overflow-hidden shadow-2xl shadow-signal/5 transform scale-95 transition-transform duration-300" id="terminal-window">
      <!-- Terminal Header -->
      <div class="h-8 bg-zinc-900/50 border-b border-zinc-800 flex items-center justify-between px-4">
        <div class="flex items-center gap-2">
           <div class="w-3 h-3 rounded-full bg-red-500/50 hover:bg-red-500 transition-colors cursor-pointer" id="term-close-dot"></div>
           <div class="w-3 h-3 rounded-full bg-yellow-500/50"></div>
           <div class="w-3 h-3 rounded-full bg-green-500/50"></div>
        </div>
        <div class="font-mono text-[10px] text-zinc-500 uppercase tracking-widest">DevUp System Console</div>
        <div class="w-10"></div> <!-- Spacer -->
      </div>
      
      <!-- Terminal Body -->
      <div class="p-6 h-[400px] overflow-y-auto font-mono text-xs md:text-sm text-zinc-300 scrollbar-hide" id="terminal-output" onclick="document.getElementById('terminal-input').focus()">
        <div class="mb-4 text-zinc-500">
           DevUp OS [Version 1.0.0]<br>
           (c) 2026 DevUp Society Corporation. All rights reserved.<br>
           <br>
           Welcome to the DevUp Console. Type <span class="text-signal">'help'</span> for a list of commands.
        </div>
        <div class="flex flex-col gap-1" id="history"></div>
        
        <div class="flex items-center gap-2 text-signal mt-2 border-t border-dashed border-zinc-800 pt-2">
           <span class="hidden md:inline">root@devup:~#</span>
           <span class="md:hidden">></span>
           <input type="text" id="terminal-input" class="bg-transparent border-none outline-none flex-1 text-white caret-signal uppercase font-mono" autocomplete="off" spellcheck="false" placeholder="ENTER COMMAND...">
           <button id="terminal-submit" class="px-2 text-signal hover:text-white transition-colors" aria-label="Execute Command">
             <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 10 4 15 9 20"/><path d="M20 4v7a4 4 0 0 1-4 4H4"/></svg>
           </button>
        </div>
      </div>
    </div>
  </div>

  <script is:inline>
    // --- SEARCH/TERMINAL LOGIC ---
    const terminalOverlay = document.getElementById('dev-terminal');
    const terminalWindow = document.getElementById('terminal-window');
    const terminalInput = document.getElementById('terminal-input');
    const terminalOutput = document.getElementById('history');
    const termBtn = document.getElementById('terminal-btn');
    const mobileTermBtn = document.getElementById('mobile-terminal-btn');
    const termCloseDot = document.getElementById('term-close-dot');

    let isTermOpen = false;

    function openTerminal() {
        if(document.getElementById('mobile-menu')) {
            closeMobileMenu(); // Close mobile menu if open
        }
        terminalOverlay.classList.remove('hidden');
        // Small delay for transition
        setTimeout(() => {
            terminalOverlay.classList.remove('opacity-0');
            terminalWindow.classList.remove('scale-95');
            terminalOverlay.classList.add('opacity-100');
            terminalWindow.classList.add('scale-100');
            terminalInput.focus();
        }, 10);
        isTermOpen = true;
    }

    function closeTerminal() {
        terminalOverlay.classList.remove('opacity-100');
        terminalWindow.classList.remove('scale-100');
        terminalOverlay.classList.add('opacity-0');
        terminalWindow.classList.add('scale-95');
        setTimeout(() => {
            terminalOverlay.classList.add('hidden');
        }, 300);
        isTermOpen = false;
    }

    // Toggle on button click
    if(termBtn) {
        termBtn.addEventListener('click', openTerminal);
    }
    if(mobileTermBtn) {
        mobileTermBtn.addEventListener('click', openTerminal);
    }
    if(termCloseDot) {
        termCloseDot.addEventListener('click', closeTerminal);
    }

    // Toggle on Ctrl+K or Cmd+K
    document.addEventListener('keydown', (e) => {
        if((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            if(isTermOpen) closeTerminal();
            else openTerminal();
        }
        if(e.key === 'Escape' && isTermOpen) {
            closeTerminal();
        }
    });

    // Close on click outside
    terminalOverlay.addEventListener('click', (e) => {
        if(e.target === terminalOverlay) closeTerminal();
    });

    // Command Logic
    const termSubmitBtn = document.getElementById('terminal-submit');

    function executeCommand() {
        const command = terminalInput.value.trim(); // Don't allow empty commands to clutter, let processCommand handle casing
        if(command) {
            processCommand(command.toLowerCase());
            terminalInput.value = '';
            // On desktop keep focus, on mobile maybe not to allow reading output?
            // Let's keep focus for now to allow rapid commands.
             setTimeout(() => {
                const container = document.getElementById('terminal-output');
                container.scrollTop = container.scrollHeight;
            }, 10);
        }
    }

    terminalInput.addEventListener('keydown', (e) => {
        if(e.key === 'Enter' || e.keyCode === 13) {
            e.preventDefault();
            executeCommand();
        }
    });

    if(termSubmitBtn) {
        termSubmitBtn.addEventListener('click', executeCommand);
    }

    function addToHistory(cmd, output, isHtml = false) {
        const cmdLine = document.createElement('div');
        cmdLine.className = "flex gap-2 text-zinc-400";
        cmdLine.innerHTML = `<span class="text-signal">root@devup:~#</span> ${cmd}`;
        terminalOutput.appendChild(cmdLine);

        if(output) {
            const outputLine = document.createElement('div');
            outputLine.className = "mb-4 text-white pl-4 border-l-2 border-zinc-800 ml-1";
            if(isHtml) outputLine.innerHTML = output;
            else outputLine.innerText = output;
            terminalOutput.appendChild(outputLine);
        }
        
        // Auto scroll
        const container = document.getElementById('terminal-output');
        container.scrollTop = container.scrollHeight;
    }

    function processCommand(cmd) {
        // Normalize command
        const cleanCmd = cmd.toLowerCase().trim();

        if (cleanCmd.includes('devup') || cleanCmd === 'who are you' || cleanCmd === 'about') {
             addToHistory(cmd, `
<div class="font-mono border border-zinc-800 p-4 bg-zinc-900/50 rounded mb-2">
  <div class="text-signal font-bold text-base mb-2">/// DEVUP SOCIETY INTELLIGENCE</div>
  <p class="text-zinc-300 mb-2">We are the premier tech community for students, builders, and innovators.</p>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-xs">
    <div>
      <span class="text-zinc-500 block">MISSION</span>
      <span class="text-white">To maintain a global standard of excellence in skills, innovation, and impact.</span>
    </div>
    <div>
      <span class="text-zinc-500 block">STANDARD</span>
      <span class="text-white">Apple-level polish. Stripe-level clarity.</span>
    </div>
  </div>
  <div class="mt-4 pt-4 border-t border-zinc-800">
    <span class="text-signal">> STATUS:</span> <span class="text-white">OPERATIONAL</span><br>
    <span class="text-signal">> NEXT EVENT:</span> <a href="/events" class="underline hover:text-white decoration-zinc-600">CHECK CALENDAR</a>
  </div>
</div>`, true);
             return;
        }

        switch(cleanCmd) {
            case 'help':
                addToHistory(cmd, `AVAILABLE COMMANDS:
  help        - Show this menu
  devup       - System Info / Mission
  clear       - Clear terminal
  home        - Go to Homepage
  events      - Navigate to Events
  team        - Meet the Team
  join        - Join Community
  socials     - List Social Links
  hack        - [EXPERIMENTAL]
  exit        - Close Console`, false);
                break;
            case 'exit':
                closeTerminal();
                break;
            case 'sudo':
                addToHistory(cmd, 'PERMISSION DENIED. YOU ARE NOT ADMIN.', false);
                break;
            case 'clear':
                terminalOutput.innerHTML = '';
                break;
            case 'home':
                addToHistory(cmd, 'Navigating to HOME...');
                setTimeout(() => window.location.href = '/', 500);
                break;
            case 'events':
                addToHistory(cmd, 'Navigating to EVENTS...');
                setTimeout(() => window.location.href = '/events', 500);
                break;
            case 'team':
                addToHistory(cmd, 'Navigating to TEAM...');
                setTimeout(() => window.location.href = '/team', 500);
                break;
             case 'join':
                addToHistory(cmd, 'Initiating Join Protocol...');
                setTimeout(() => window.location.href = '/join', 500);
                break;
            case 'date':
                addToHistory(cmd, new Date().toString());
                break;
            case 'socials':
                addToHistory(cmd, `
<a href="https://github.com/DevUp-Society" target="_blank" class="text-blue-400 hover:text-signal hover:underline">GITHUB</a>
<br><a href="https://www.linkedin.com/company/devup-community" target="_blank" class="text-blue-400 hover:text-signal hover:underline">LINKEDIN</a>
<br><a href="https://www.instagram.com/devupcommunity/" target="_blank" class="text-blue-400 hover:text-signal hover:underline">INSTAGRAM</a>`, true);
                break;
            case 'hack':
                const hackSteps = [
                    "INITIATING BREACH PROTOCOL...",
                    "BYPASSING FIREWALL (PORT 443)...",
                    "INJECTING SQL PAYLOAD...",
                    "ACCESSING MAINFRAME... [SUCCESS]",
                    "DOWNLOADING 'SECRET_PLANS.PDF'...",
                    "DECRYPTING PASSWORDS...",
                    "...WAIT...",
                    "⚠️ SECURITY ALERT TRIGGERED ⚠️",
                    "TRACING IP ADDRESS...",
                    "CONNECTION TERMINATED."
                ];
                
                let step = 0;
                addToHistory(cmd, hackSteps[0], false);
                
                const hackInterval = setInterval(() => {
                    step++;
                    if(step < hackSteps.length) {
                         const line = document.createElement('div');
                         line.className = "mb-1 text-zinc-300 pl-4 border-l-2 border-zinc-800 ml-1 font-mono text-xs";
                         line.innerText = hackSteps[step];
                         
                         if(hackSteps[step].includes("ALERT") || hackSteps[step].includes("TERMINATED")) {
                             line.classList.add("text-red-500", "font-bold");
                         }
                         if(hackSteps[step].includes("SUCCESS")) {
                             line.classList.add("text-signal");
                         }
                         
                         terminalOutput.appendChild(line);
                         
                         // Auto scroll
                         const container = document.getElementById('terminal-output');
                         container.scrollTop = container.scrollHeight;
                         
                         // Random glitch effect
                         if(Math.random() > 0.5) {
                             document.body.classList.add('invert'); 
                             setTimeout(() => document.body.classList.remove('invert'), 100);
                         }
                    } else {
                        clearInterval(hackInterval);
                    }
                }, 800);
                break;
            case '':
                addToHistory('', '', false);
                break;
            default:
                addToHistory(cmd, `Command not found: ${cmd}. Type 'help' for valid commands.`);
        }
    }

    // @ts-nocheck - GSAP loaded from CDN, types not available at build time
    
    // --- LOADER LOGIC ---
    const loader = document.getElementById('loader');
    const loaderText = document.getElementById('loader-text');
    const loaderBar = document.getElementById('loader-bar');
    const loaderStatus = document.getElementById('loader-status');
    const loaderSystem = document.getElementById('loader-system');
    const bootLog = document.getElementById('boot-log');
    
    // Tech-jargon for the status text
    const statusMessages = [
      "INITIALIZING KERNEL...",
      "LOADING ASSETS...",
      "ESTABLISHING UPLINK...",
      "DECRYPTING PROTOCOLS...",
      "SYNCING DATA STREAMS...",
      "SYSTEM OPTIMIZED"
    ];

    // Tech-jargon for background log
    const logLines = [
        "Allocating memory block 0x000F4A...",
        "Loading kernel modules [OK]",
        "Mounting ZFS filesystem...",
        "Checking dependencies: node_modules [OK]",
        "Starting network interface wlan0...",
        "Bypassing firewall proxy 127.0.0.1...",
        "Injecting CSS variables...",
        "Compiling Astro islands...",
        "Handshaking with satellite VJIT-SAT-1...",
        "Decrypting user token sha256...",
        "Optimizing rendering engine...",
        "Flush DNS cache...",
        "Establishing secure connection TLS 1.3...",
        "Loading textures: noise.png...",
        "Loading fonts: Space Grotesk...",
        "Initializing WebGL context...",
        "VRAM Integrity Check: PASSED",
        "Cyber-Security Protocols: ACTIVE"
    ];

    const isHomePage = window.location.pathname === '/';
    
    if (!isHomePage) {
      loader.style.display = 'none';
      document.body.classList.remove('loading');
    } else {
      let progress = 0;
      let statusIndex = 0;
      
      const interval = setInterval(() => {
        progress += Math.floor(Math.random() * 8) + 2; 
        if(progress > 100) progress = 100;
        
        loaderText.innerText = progress < 100 ? `0${progress}` : '100';
        loaderBar.style.width = `${progress}%`;
        
        // Update Status
        if (progress % 20 === 0 && statusIndex < statusMessages.length) {
             loaderStatus.innerText = statusMessages[statusIndex];
             statusIndex++;
        }

        // Add Matrix/Boot Log lines randomly
        if(Math.random() > 0.3) {
            const line = document.createElement('div');
            line.innerText = `> ${logLines[Math.floor(Math.random() * logLines.length)]}`;
            // Random opacity for depth
            line.style.opacity = (Math.random() * 0.7 + 0.3).toFixed(1); 
            bootLog.appendChild(line);
            // Keep DOM light
            if(bootLog.childElementCount > 12) bootLog.removeChild(bootLog.firstChild);
        }
        
        if(progress === 100) {
          clearInterval(interval);
          loaderStatus.innerText = "ACCESS GRANTED";
          loaderSystem.innerText = "ONLINE";
          loaderSystem.classList.add('animate-pulse');
          loaderText.style.color = '#CCFF00';
          loaderBar.parentElement.style.boxShadow = "0 0 20px #CCFF00";
          
          setTimeout(() => {
            // Slide up
            loader.style.transform = 'translateY(-100%)';
            document.body.classList.remove('loading');
            
            // Clear log to save memory
            setTimeout(() => { 
                bootLog.innerHTML = ''; 
                loader.style.display = 'none';
            }, 1000);
          }, 400); // 400ms pause at 100%
        }
      }, 30);
    }

    // --- CURSOR LOGIC ---
    const cursorDot = document.querySelector('.cursor-dot');
    const cursorRing = document.querySelector('.cursor-ring');

    if (window.matchMedia("(pointer: fine)").matches && cursorDot && cursorRing) {
      let mouseX = 0, mouseY = 0;
      let ringX = 0, ringY = 0;

      window.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        cursorDot.style.transform = `translate(${mouseX}px, ${mouseY}px) translate(-50%, -50%)`;
      });

      const animateRing = () => {
        ringX += (mouseX - ringX) * 0.3; // Increased from 0.15 to 0.3 for faster response
        ringY += (mouseY - ringY) * 0.3;
        cursorRing.style.transform = `translate(${ringX}px, ${ringY}px) translate(-50%, -50%)`;
        requestAnimationFrame(animateRing);
      }
      animateRing();

      // Interactive Elements
      document.querySelectorAll('a, button, .spotlight-card').forEach((el) => {
        el.addEventListener('mouseenter', () => {
          cursorRing.style.width = '50px';
          cursorRing.style.height = '50px';
          cursorRing.style.backgroundColor = 'rgba(204, 255, 0, 0.1)';
          cursorRing.style.borderColor = 'transparent';
        });
        el.addEventListener('mouseleave', () => {
          cursorRing.style.width = '20px';
          cursorRing.style.height = '20px';
          cursorRing.style.backgroundColor = 'transparent';
          cursorRing.style.borderColor = 'rgba(204, 255, 0, 0.5)';
        });
      });
    }

    // --- SPOTLIGHT EFFECT ---
    const cards = document.querySelectorAll('.spotlight-card');
    window.addEventListener('mousemove', (e) => {
      cards.forEach((card) => {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        card.style.setProperty("--mouse-x", `${x}px`);
        card.style.setProperty("--mouse-y", `${y}px`);
      });
    });

    // --- GSAP ANIMATIONS ---
    // Wait for GSAP to load from CDN
    if (typeof gsap !== 'undefined' && typeof ScrollTrigger !== 'undefined') {
      gsap.registerPlugin(ScrollTrigger);

      // Scroll reveal for sections
      gsap.utils.toArray('section').forEach((section) => {
        gsap.from(section.querySelectorAll('h2, h3, p'), {
          scrollTrigger: {
            trigger: section,
            start: "top 80%",
            toggleActions: "play none none reverse"
          },
          y: 30,
          opacity: 0,
          duration: 0.8,
          stagger: 0.1,
          ease: "power3.out"
        });
      });
    }
  </script>
</body>
</html>
